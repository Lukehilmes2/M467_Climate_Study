years = c(13,14,15)

#Declare names of all available data tables for 2013
SexByAge13 = paste("ACS_",years[1],"_5YR_B01001_with_ann.csv",sep = "")
TransToWork13 = paste("ACS_",years[1],"_5YR_B08301_with_ann.csv",sep = "")
HouseholdType13 = paste("ACS_",years[1],"_5YR_B11001_with_ann.csv",sep = "")
PovertyStatus13 = paste("ACS_",years[1],"_5YR_B17017_with_ann.csv",sep = "")
HouseholdIncome13 = paste("ACS_",years[1],"_5YR_B19001_with_ann.csv",sep = "")
ContractRent13 = paste("ACS_",years[1],"_5YR_B25056_with_ann.csv",sep = "")
Value13 = paste("ACS_",years[1],"_5YR_B25075_with_ann.csv",sep = "")

#read in csv files of all available data tables for 2013
dfSexByAge13 = read.csv(SexByAge13)
dfTransToWork13 = read.csv(TransToWork13)
dfHouseholdType13 = read.csv(HouseholdType13)
dfPovertyStatus13 = read.csv(PovertyStatus13)
dfHouseholdIncome13 = read.csv(HouseholdIncome13)
dfContractRent13 = read.csv(ContractRent13)
dfValue13 = read.csv(Value13)

#Declare uniform GeoID and display name column in ACS2013
ACS2013 <- cbind.data.frame(dfSexByAge13$GEO.id2)
ACS2013$Display <- (dfSexByAge13$GEO.display.label)
ACS2013$TotalPopulation <- (dfSexByAge13$HD01_VD01)
#Rename the columns in ACS2013 to be easier to work with
colnames(ACS2013) <- c("GEOID2","Display","TotalPopulation")
ACS2013 = ACS2013[-1,]
#We want peple who are more susceptible to illness: Kids and Elderly
#Sum of kids <= 9 years old
head(as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD03)))
ACS2013$numKids13 <-((as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD03)))+
  as.numeric(as.character((dfSexByAge13[-1,]$HD01_VD04)))+ 
  as.numeric(as.character((dfSexByAge13[-1,]$HD01_VD27)))+ 
  as.numeric(as.character((dfSexByAge13[-1,]$HD01_VD28))))

#sum of adults >= 65 years old
ACS2013$numElderly13 <-(as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD20))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD21))+ 
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD22))+ 
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD23))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD24))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD25))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD44))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD45))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD46))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD47))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD48))+
                        as.numeric(as.character(dfSexByAge13[-1,]$HD01_VD49)))

#Means of transportation to work will be used as a pseudo predictor of income
#Own vehicle/Carpool/Motorcycle,public transportation, bike/walk/other means
ACS2013$numVehicles<-(as.numeric(as.character(dfTransToWork13[-1,]$HD01_VD02))+
                      as.numeric(as.character(dfTransToWork13[-1,]$HD01_VD17))
                      )
ACS2013$publicTrans<-(dfTransToWork13[-1,]$HD01_VD10)

ACS2013$walkOrBike <- (as.numeric(as.character(dfTransToWork13[-1,]$HD01_VD18))+
                       as.numeric(as.character(dfTransToWork13[-1,]$HD01_VD19))+
                       as.numeric(as.character(dfTransToWork13[-1,]$HD01_VD20)))
  

sum(as.numeric(as.character(ACS2013$TotalPopulation)))

#Merge all columns of available data tables for 2013 into 1 data frame 
ACS2013 <- cbind.data.frame(dfSexByAge13,dfTransToWork13,dfHouseholdType13,dfPovertyStatus13,
                 dfHouseholdIncome13,dfHousingUnits13,dfContractRent13,dfValue13)

#Output 2013 file to csv named "ACS2013_5YR"
write.csv(ACS2013, "ACS2013_5YR.csv")








